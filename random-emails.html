<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel=icon href=/apps/favicon.ico>
	<title>Random Email Generator</title>
	<script src="https://cdn.tailwindcss.com"></script>
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
	<style>
		body {
			font-family: 'Inter', sans-serif;
			background-color: #f7f9fb;
			display: flex;
			justify-content: center;
			align-items: center;
			min-height: 100vh;
			padding: 20px;
		}
	</style>
</head>
<body>

<div class="w-full max-w-lg bg-white p-8 md:p-10 rounded-xl shadow-2xl transition-all duration-300">
	<div class="text-right mb-2 pb-6 border-b">
		<a href="/apps" class="inline-flex justify-center py-2 px-4 border border-transparent rounded-lg shadow-lg text-xs font-medium text-white bg-gray-600 hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition duration-150 transform hover:scale-[1.01] active:scale-[0.98]">&lt; BACK</a>
	</div>

	<h1 class="text-3xl font-bold text-gray-800 mb-6 border-b pb-2">Batch Email Generator</h1>
	<p class="text-gray-500 mb-6">Generate unique placeholder email addresses for testing or development.</p>

	<!-- Input Section -->
	<div class="space-y-4">
		<div>
			<label for="quantity" class="block text-sm font-medium text-gray-700">Number of Emails (Max 500)</label>
			<input type="number" id="quantity" value="25" min="1" max="500" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 transition duration-150" placeholder="e.g., 100">
		</div>

		<div>
			<label for="domain" class="block text-sm font-medium text-gray-700 flex items-center justify-between">
				Domain Name
				<div class="flex items-center">
					<input id="randomDomainToggle" type="checkbox" checked class="h-4 w-4 text-indigo-600 border-indigo-500/50 rounded focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:ring-opacity-25 mr-2">
					<label for="randomDomainToggle" class="text-xs font-medium text-gray-500 select-none">Use Random Domains</label>
				</div>
			</label>
			<input type="text" id="domain" value="" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 transition duration-150" placeholder="Random domain will be used" disabled>
		</div>

		<button id="generateBtn" class="w-full flex justify-center py-2 px-4 border border-transparent rounded-lg shadow-lg text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition duration-150 transform hover:scale-[1.01] active:scale-[0.98]">
			Generate Emails
		</button>
	</div>

	<!-- Output Section -->
	<div class="mt-8">
		<div class="flex justify-between items-center mb-2">
			<h2 class="text-xl font-semibold text-gray-800">Results</h2>
			<button id="copyBtn" class="flex items-center space-x-1 text-sm text-indigo-600 hover:text-indigo-800 disabled:opacity-50 disabled:cursor-not-allowed transition duration-150" disabled>
				<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
				  <path d="M7 9a2 2 0 012-2h6a2 2 0 012 2v6a2 2 0 01-2 2H9a2 2 0 01-2-2V9z" />
				  <path d="M5 3a2 2 0 00-2 2v6a2 2 0 002 2V5h6a2 2 0 00-2-2H5z" />
				</svg>
				<span id="copyText">Copy All</span>
			</button>
		</div>

		<div id="results" class="h-60 bg-gray-50 border border-gray-300 rounded-lg p-3 text-sm text-gray-800 overflow-y-auto whitespace-pre-wrap">
			The generated emails will appear here.
		</div>
	</div>

	<!-- Message Box for Custom Alerts -->
	<div id="messageBox" class="fixed inset-0 bg-gray-900 bg-opacity-50 hidden items-center justify-center p-4 z-50">
		<div class="bg-white p-6 rounded-lg shadow-xl max-w-sm w-full">
			<h3 id="messageTitle" class="text-lg font-bold text-gray-800 mb-3"></h3>
			<p id="messageContent" class="text-gray-600 mb-4"></p>
			<button onclick="closeMessageBox()" class="w-full py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition">
				OK
			</button>
		</div>
	</div>
</div>

<script>
	// --- Message Box Logic (Custom Alert Replacement) ---
	const messageBox = document.getElementById('messageBox');
	const messageTitle = document.getElementById('messageTitle');
	const messageContent = document.getElementById('messageContent');

	function showMessageBox(title, content) {
		messageTitle.textContent = title;
		messageContent.textContent = content;
		messageBox.classList.remove('hidden');
		messageBox.classList.add('flex');
	}

	function closeMessageBox() {
		messageBox.classList.add('hidden');
		messageBox.classList.remove('flex');
	}

	// --- Core Generator Logic ---
	const quantityInput = document.getElementById('quantity');
	const domainInput = document.getElementById('domain');
	const generateBtn = document.getElementById('generateBtn');
	const copyBtn = document.getElementById('copyBtn');
	const resultsDiv = document.getElementById('results');
	const copyTextSpan = document.getElementById('copyText');
	const randomDomainToggle = document.getElementById('randomDomainToggle');

	const characters = 'abcdefghijklmnopqrstuvwxyz0123456789';

	// List of common, non-production placeholder domains
	const RANDOM_DOMAINS = [
		'testmail.com',
		'example.org',
		'fakemail.net',
		'inbox.test',
		'dev.co',
		'temp.io',
		'mockup.xyz',
		'webtest.info',
		'example.com',
		'example.net',
		'invalid.qa',
		'localhost.test',
		'contoso.com',
		'test.qa',
		'dev.test'
	];

	/**
	 * Toggles the state of the domain input field based on the checkbox.
	 */
	function toggleDomainInput() {
		const isRandom = randomDomainToggle.checked;
		domainInput.disabled = isRandom;
		if (isRandom) {
			domainInput.placeholder = "Random domain will be used for each email";
			domainInput.value = "";
		} else {
			domainInput.placeholder = "e.g., example.com";
			// Set a default value when switching back to manual entry
			if (!domainInput.value) {
				domainInput.value = "example.com";
			}
		}
	}

	/**
	 * Generates a random alphanumeric username part.
	 * @param {number} length - The desired length of the username.
	 * @returns {string} The random username.
	 */
	function generateUsername(length = 8) {
		let result = '';
		const charsLength = characters.length;
		for (let i = 0; i < length; i++) {
			// Ensure the first character is a letter
			if (i === 0) {
				 const letters = 'abcdefghijklmnopqrstuvwxyz';
				 result += letters.charAt(Math.floor(Math.random() * letters.length));
			} else {
				result += characters.charAt(Math.floor(Math.random() * charsLength));
			}
		}
		return result;
	}

	/**
	 * Generates a batch of unique email addresses.
	 */
	function generateEmails() {
		const quantity = parseInt(quantityInput.value);
		let fixedDomain = null; // Stores the domain if the user selected manual input

		// Input validation
		if (isNaN(quantity) || quantity <= 0) {
			showMessageBox('Invalid Input', 'Please enter a valid number greater than 0.');
			return;
		}
		if (quantity > 500) {
			showMessageBox('Quantity Limit', 'The maximum allowed quantity is 500.');
			return;
		}

		// --- Domain Pre-Check (Only for Manual Input) ---
		if (!randomDomainToggle.checked) {
			fixedDomain = domainInput.value.trim().toLowerCase();

			if (fixedDomain === '') {
				showMessageBox('Domain Required', 'Please enter a domain name (e.g., example.com).');
				return;
			}
			// Clean up domain: remove leading '@' if present
			if (fixedDomain.startsWith('@')) {
				fixedDomain = fixedDomain.substring(1);
			}
		}
		// --- End Domain Pre-Check ---

		const generatedEmails = new Set();
		const maxAttempts = quantity * 2; // Prevent infinite loop for large quantities
		let attempts = 0;

		while (generatedEmails.size < quantity && attempts < maxAttempts) {
			let currentDomain;

			if (randomDomainToggle.checked) {
				// If random is checked, pick a NEW domain for every email
				const randomIndex = Math.floor(Math.random() * RANDOM_DOMAINS.length);
				currentDomain = RANDOM_DOMAINS[randomIndex];
			} else {
				// If not random, use the fixed domain validated above
				currentDomain = fixedDomain;
			}

			// Username length between 6 and 12 characters
			const username = generateUsername(Math.floor(Math.random() * (12 - 6 + 1)) + 6);
			const email = `${username}@${currentDomain}`; // Use the chosen domain

			generatedEmails.add(email);
			attempts++;
		}

		const emailsArray = Array.from(generatedEmails);
		resultsDiv.textContent = emailsArray.join('\n');

		// Enable copy button and reset text
		copyBtn.disabled = emailsArray.length === 0;
		copyTextSpan.textContent = 'Copy All';

		if (emailsArray.length < quantity) {
			 showMessageBox('Warning', `Could only generate ${emailsArray.length} unique emails after ${maxAttempts} attempts.`);
		}
	}

	/**
	 * Copies the content of the results div to the clipboard.
	 */
	function copyToClipboard() {
		const textToCopy = resultsDiv.textContent;
		if (textToCopy === 'The generated emails will appear here.' || textToCopy.trim() === '') {
			showMessageBox('Nothing to Copy', 'Please generate some emails first.');
			return;
		}

		// Use document.execCommand('copy') for better compatibility in iframe environments
		const tempTextarea = document.createElement('textarea');
		tempTextarea.value = textToCopy;
		document.body.appendChild(tempTextarea);
		tempTextarea.select();

		try {
			document.execCommand('copy');
			copyTextSpan.textContent = 'Copied!';
			// Reset text after a delay
			setTimeout(() => { copyTextSpan.textContent = 'Copy All'; }, 2000);
		} catch (err) {
			showMessageBox('Copy Failed', 'Unable to copy text. Please select and copy manually.');
			console.error('Copy failed:', err);
		} finally {
			document.body.removeChild(tempTextarea);
		}
	}

	// Attach event listeners
	generateBtn.addEventListener('click', generateEmails);
	copyBtn.addEventListener('click', copyToClipboard);
	randomDomainToggle.addEventListener('change', toggleDomainInput);

	// Initial setup on load
	window.onload = () => {
		toggleDomainInput(); // Set initial state (disabled)
		generateEmails();    // Generate initial batch with random domains
	};
</script>

</body>
</html>